(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7516],{13201:e=>{e.exports={SubscribeBanner:"SubscribeBanner_SubscribeBanner__GPym6",RosieMessage:"SubscribeBanner_RosieMessage__7zaYY",fadeAndScaleIn:"SubscribeBanner_fadeAndScaleIn___eFuq",fadeAndScaleOut:"SubscribeBanner_fadeAndScaleOut__qCHGu",scaleIn:"SubscribeBanner_scaleIn__7S1TE",scaleOut:"SubscribeBanner_scaleOut__qpsy1"}},26555:(e,t,n)=>{"use strict";n.d(t,{default:()=>A});var a=n(95155),r=n(52596),s=n(12115),o=n(88248),i=n(99975),c=n(35758),l=n(27156),u=n(47745),d=n(89051),p=n(23172),m=n(29361),f=n(77268),g=n.n(f);let A=(0,s.forwardRef)(function(e,t){let{projectId:n,revisionId:f,onEvalError:A,showFullScreenButton:E=!0}=e,{requireSignIn:S,user:h}=(0,p.As)(),{authStatus:v}=(0,p.lB)(),[b,w]=(0,s.useState)(!1),_=(0,s.useRef)(null),[I,y]=(0,s.useState)(!1),{submitPoints:T}=(0,m.O$)(null==h?void 0:h.id,null==h?void 0:h.is_anonymous,n),C=(0,s.useRef)(null),R=(0,s.useRef)(0),M=(0,s.useRef)(null),[O,H]=(0,s.useState)(!1);async function L(e){let t,n=e.data.payload,a=e.data.requestId;try{t={blob:await (0,o.mP)(n)}}catch(e){console.error(e),t={message:"Error fetching asset generation response"}}e.source.postMessage({action:"ephemeralImageGenerationResponse",content:t,requestId:a},e.origin)}return(0,s.useImperativeHandle)(t,()=>({iframe:_.current,takeScreenshot:()=>new Promise((e,t)=>{var n;if(!(null==(n=_.current)?void 0:n.contentWindow))return console.error("[Universal] Cannot request screenshot: iframe not ready."),e(null);if(C.current)return console.warn("[Universal] Screenshot request already in progress."),t(Error("Screenshot request already in progress."));C.current=e,_.current.contentWindow.postMessage({action:"requestScreenshot"},"*");let a=setTimeout(()=>{C.current&&(console.error("[Universal] Screenshot request timed out."),C.current(null),C.current=null)},5e3),r=C.current;C.current=e=>{clearTimeout(a),r&&r(e),C.current=null}})}),[]),(0,s.useEffect)(()=>{async function e(e){let t;(0,i.mO)(n);let a=e.data.payload;a.project_id=n;let r=e.data.requestId;try{t=await (0,o.rJ)(a)}catch(n){var s,c;let e="Error fetching LLM response";(null==(s=n.response)?void 0:s.status)===403&&(null==(c=n.response.data)?void 0:c.detail)==="No more entitlements available"&&("AUTHENTICATED"===v?y(!0):S({callbackIfSignedOut:()=>{}}),e="AUTHENTICATED"===v?"Subscribe for unlimited messages":"Sign in to continue using AI Chat"),console.error(n),t={message:e}}e.source.postMessage({action:"llmResponse",content:t,requestId:r},e.origin)}async function t(e){let t=e.data.points;(0,i.YH)(t);let n=e.data.requestId,a=await T(t);e.source.postMessage({action:"ogpSubmitPoints",content:a,requestId:n},e.origin)}let a=async n=>{let a=n.data.action;if("codeError"===a&&A&&(R.current++,M.current||(M.current=setTimeout(()=>{R.current>10&&H(!0),M.current=null,R.current=0},1e3)),A(n.data.content)),"logProgress"===a&&(0,i.n1)(n.data.content.eventName,n.data.content.eventData),"requestLLM"===a&&await e(n),"requestEphemeralImageGeneration"===a&&await L(n),"ogpSubmitPoints"===a&&await t(n),"screenshotResponse"===a){let{content:e}=n.data;C.current&&C.current(e)}};return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}},[A,n,v,S,T]),(0,a.jsxs)("div",{className:(0,r.A)(g().Root,b&&g().FullScreen),children:[E&&(0,a.jsx)("button",{onClick:()=>{w(e=>!e)},className:g().FullScreenButton,children:b?(0,a.jsx)(l.A,{}):(0,a.jsx)(c.A,{})}),!O&&(0,a.jsx)("iframe",{ref:_,src:"".concat("https://playground-gateway-v2-snduoq54tq-uc.a.run.app","/api/server/").concat(f,"/index.html"),className:g().RenderDiv,sandbox:"allow-scripts allow-same-origin allow-pointer-lock allow-downloads allow-forms allow-popups",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;"}),O&&(0,a.jsxs)("div",{className:g().InfiniteErrorContainer,children:[(0,a.jsx)(d.i,{}),(0,a.jsx)("span",{children:"Infinite error loop detected. Please check your code."})]}),I&&(0,a.jsx)("div",{className:g().SubscribeBannerContainer,children:(0,a.jsx)(u.A,{message:"To continue enjoying the AI chat features in this project, please upgrade your plan."})})]})})},27156:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a,r,s=n(12115);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}let i=function(e){return s.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 22 22"},e),a||(a=s.createElement("path",{d:"M11.917 11.917v7.333h1.833v-3.666h1.833V13.75h3.667v-1.833h-7.333m-3.667-5.5V2.75h1.833v7.333H2.75V8.25h5.5-1.833V6.417z"})),r||(r=s.createElement("path",{d:"M11.917 11.917v7.333h1.833v-3.666h1.833V13.75h3.667v-1.833h-7.333m-3.667-5.5V2.75h1.833v7.333H2.75V8.25h5.5-1.833V6.417zM11.917 10.083h7.333V8.25h-3.667V6.417H13.75V2.75h-1.833v7.333m-5.5 3.667H2.75v-1.833h7.333v7.333H8.25v-5.5 1.833H6.417z"})))}},29361:(e,t,n)=>{"use strict";n.d(t,{Nb:()=>_,O$:()=>I});var a=n(95155),r=n(95838),s=n(5041),o=n(12115),i=n(65453),c=n(23464),l=n(35695);let u=c.A.create({baseURL:"https://api.staging.opengameprotocol.com"});async function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.headers={...n.headers,Authorization:"Bearer ".concat(t),"x-auth-provider":"player"};try{return await u(e,n)}catch(e){var a;throw c.A.isAxiosError(e)&&(null==(a=e.response)?void 0:a.status)===404&&(0,l.notFound)(),e}}async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.headers={...t.headers,"Content-Type":"application/json"},await u(e,t)}async function m(e,t){return(await p("/game/getSessionToken?playerId=".concat(e,"&apiKey=").concat("b772733e-0d91-44f5-93ad-9d0ae979ba42","&gameId=").concat(t),{method:"GET"})).data}async function f(e){return(await d("/game/savePoints",e.token,{method:"POST",data:{points:e.points}})).data}var g=n(99975),A=n(23172),E=n(82104),S=n.n(E);function h(e){let{onSignIn:t}=e,{signOut:n,requireSignIn:r}=(0,A.As)(),{authStatus:s}=(0,A.lB)(),o=async()=>{"AUTHENTICATED"===s?n():r({callbackIfSignedIn:()=>{t()},autoCloseDialog:!0})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:"You have earned points, but they will be lost unless you sign in to Rosebud!"}),(0,a.jsx)("button",{className:S().OGPAuthButton,onClick:o,children:"AUTHENTICATED"===s?"Sign Out":"Sign In to Rosebud"})]})}var v=n(70689);let b=(0,i.v)(e=>({ogpInstance:null,setOgpInstance:t=>e({ogpInstance:t})}));async function w(e){let t=new(await n.e(4897).then(n.bind(n,74897))).default({useCustomAuth:!0});return t.init({gameId:e}),t.gameReadyToPlay(),t}let _=["3bebe390-06da-4b16-a84c-b0db380a00b5","f34b869b-eb9c-4fe9-afa1-c7f9d0b86d4e","69b4edcb-4ff5-437b-80a2-208208e39c51","9381a1a1-6021-4769-a3bb-352427681e3b","623e16a2-d7a1-4a65-9447-c8732659562d","d20f4673-b62d-4a76-8564-f64a839f7136","56a9fb21-bb68-4819-bd9c-a841f8c3289c"];function I(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,[i,c]=(0,o.useState)(!1),{setOpen:l,setContent:u}=(0,v.s)(),d=(0,o.useRef)(!1),{ogpInstance:p,setOgpInstance:A}=b(),E=null!==p;(0,o.useEffect)(()=>{let e=async()=>{!E&&(p||A(await w(n)))};_.includes(n)&&e()},[n,E,p,A]),(0,o.useEffect)(()=>{E&&void 0!==e&&E&&p.setPlayerId(e)},[e,E,p]),(0,o.useEffect)(()=>{(0,g.yu)().then(e=>{E&&void 0!==e&&p&&(console.log("Setting custom auth token: ".concat(e)),p.setCustomAuthToken(e))})},[E,p]);let{data:S,refetch:I}=(0,r.I)({queryKey:["ogp-user-session",e],queryFn:()=>m(e,n),enabled:void 0!==e&&i}),y=null==S?void 0:S.data.token,T=(0,s.n)({mutationFn:f,onError:()=>{console.error("Submit points error")},onSettled:()=>{console.log("Submit points success")}});async function C(){if(E&&p)return await p.getPoints()}async function R(){if(E&&p)return(await p.listGameRewards()).total}async function M(){if(E&&p)return await p.claimRewards(!0)}return{submitPoints:(0,o.useCallback)(async n=>{if(t&&!d.current){d.current=!0,u({body:(0,a.jsx)(h,{onSignIn:()=>l(!1)}),title:"Sign in required to save points"}),l(!0);return}let r=y;if(!i&&void 0!==e){var s;c(!0),r=null==(s=(await I()).data)?void 0:s.data.token}if(r)return(await T.mutateAsync({token:r,points:n})).data.savePoints},[i,e,y,t,T,I,u,l]),listPoints:C,listRewards:R,claimRewards:M,isSDKLoaded:E}}},30546:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});let a="16"},35758:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a,r=n(12115);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}let o=function(e){return r.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 22 22"},e),a||(a=r.createElement("path",{fill:"currentColor",d:"M11.917 2.75h7.333v7.333h-1.833V6.417h-1.834V4.583h-3.666zm-7.334 9.167v3.666h1.834v1.834H4.583h5.5v1.833H2.75v-7.333zM19.25 11.917v7.333h-7.333v-1.833h3.666v-1.834h1.834v-3.666zm-9.167-7.334H6.417v1.833H4.583V4.583v5.5H2.75V2.75h7.333z"})))}},43614:(e,t,n)=>{"use strict";n.d(t,{B:()=>r});var a=n(66977);function r(e){if(e==a.Kt.BABYLON)return"babylon";if(e==a.Kt.PHASER)return"phaser";if(e==a.Kt.VOXEL)return"noa";if(e==a.Kt.THREEJS)return"threejs";if(e==a.Kt.REACT)return"react";else if(e==a.Kt.MULTIFILE)return"esm-react";throw Error("Project mode not supported!")}},47745:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(95155),r=n(66766),s=n(6874),o=n.n(s),i=n(94784),c=n(13201),l=n.n(c);function u(e){let{message:t}=e;return(0,a.jsxs)("div",{className:l().SubscribeBanner,children:[(0,a.jsxs)("div",{className:l().RosieMessage,children:[(0,a.jsx)(r.default,{src:i.default,alt:"Rosie Portrait",height:40,width:40,className:l().RosiePortrait}),(0,a.jsx)("span",{children:t})]}),(0,a.jsx)(o(),{href:"/profile/my-plan",children:"Upgrade Plan"})]})}},62605:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var a=n(95155),r=n(68591),s=n(73914),o=n(43614);function i(e){let{files:t,projectId:n,mode:i,onScriptsLoaded:c}=e,l=(0,o.B)(i);return"esm-react"===l?(0,a.jsx)(s.A,{files:t,projectId:n,canvasType:l,onScriptsLoaded:c,showFullScreenButton:!1}):(0,a.jsx)(r.A,{file:t[0],projectId:n,canvasType:l,onScriptsLoaded:c,showFullScreenButton:!1})}},66977:(e,t,n)=>{"use strict";n.d(t,{Go:()=>o,Kt:()=>a,PW:()=>r,XJ:()=>c,sy:()=>l,xZ:()=>s});var a=function(e){return e.PHASER="Phaser",e.BABYLON="Babylon",e.VOXEL="Voxel",e.THREEJS="ThreeJS",e.REACT="React",e.MULTIFILE="Multifile",e.UNIVERSAL="Universal",e}({}),r=function(e){return e.Asset2DSD="asset-2d-dreambooth",e.Asset2DSDXL="asset-2d-sdxl",e.Asset3DShape="asset-3d-shape",e.Asset3DVoxel="asset-3d-voxel",e.AssetDummy="asset-2d-dummy",e.AssetSkybox="asset-skybox",e}({}),s=function(e){return e.CHARACTER_LLM_CALL="character_llm_call",e.SUBMIT_PROMPT_CALL="submit_prompt_call",e.SUBMIT_PROMPT_CALL_LOWTIER="submit_prompt_call_lowtier",e.UNREMIXABLE_PROJECTS="unremixable_projects",e.DEPLOY_APP="deploy_app",e.EXPORT_APP="export_app",e.VIEW_CODE="view_code",e}({}),o=function(e){return e.LEGACY="LEGACY",e.USER_CHAT_MESSAGE="USER_CHAT_MESSAGE",e.ASSISTANT_CHAT_MESSAGE="ASSISTANT_CHAT_MESSAGE",e.INTENT_ASSIGNMENT="INTENT_ASSIGNMENT",e.CODE_GENERATION_MESSAGE="CODE_GENERATION_MESSAGE",e.MULTIFILE_CODE_GENERATION_MESSAGE="MULTIFILE_CODE_GENERATION_MESSAGE",e}({}),i=function(e){return e.ASSET="ASSET",e.CHAT="CHAT",e.EDIT="EDIT",e}(i||{}),c=function(e){return e.USER_MESSAGE="USER_MESSAGE",e.MESSAGE_CREATE="MESSAGE_CREATE",e.MESSAGE_UPDATE="MESSAGE_UPDATE",e.COMMIT_CREATE="COMMIT_CREATE",e.COMMIT_UPDATE="COMMIT_UPDATE",e.OPTIMISTIC_MESSAGE_UPDATE="OPTIMISTIC_MESSAGE_UPDATE",e.EXCEPTION="EXCEPTION",e.TUTORIAL_MESSAGE="TUTORIAL_MESSAGE",e.PROJECT_UPDATE="PROJECT_UPDATE",e.NEW_ASSET_MESSAGE="NEW_ASSET_MESSAGE",e}({}),l=function(e){return e.ACTIVE="ACTIVE",e.CLOSED="CLOSED",e.CANCELLED="CANCELLED",e.ERRORED="ERRORED",e}({})},68591:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var a=n(95155),r=n(52596),s=n(12115),o=n(88248),i=n(99975),c=n(35758),l=n(27156),u=n(47745),d=n(23172),p=n(29361),m=n(77268),f=n.n(m);let g=(0,s.forwardRef)(function(e,t){let{file:n,projectId:m,canvasType:g,onEvalError:A,onScriptsLoaded:E,showFullScreenButton:S=!0}=e,{requireSignIn:h,user:v}=(0,d.As)(),{authStatus:b}=(0,d.lB)(),{isClientIOS:w,handleLocalStorageChanged:_,notifyNoEntitlementsRemainingIOS:I}=function(){let[e,t]=(0,s.useState)(!1);(0,s.useEffect)(()=>{var e,n;t(void 0!==(null==(n=window.webkit)||null==(e=n.messageHandlers)?void 0:e.callbackHandler))},[]);let n=(0,s.useCallback)(async t=>{let n=t.data.content;if(e){var a,r;null==(r=window.webkit)||null==(a=r.messageHandlers)||a.callbackHandler.postMessage({action:"IframeLocalStorageChanged",content:JSON.stringify(n)})}},[e]),a=(0,s.useCallback)(()=>{if(e){var t,n;null==(n=window.webkit)||null==(t=n.messageHandlers)||t.callbackHandler.postMessage({action:"NoEntitlementsRemaining"})}},[e]);return{isClientIOS:e,handleLocalStorageChanged:n,notifyNoEntitlementsRemainingIOS:a}}(),[y,T]=(0,s.useState)(()=>"".concat("https://canvas.play.rosebud.ai","/canvas/").concat(g)),[C,R]=(0,s.useState)(!1),M=(0,s.useRef)(null),[O,H]=(0,s.useState)(!1),{submitPoints:L}=(0,p.O$)(null==v?void 0:v.id,null==v?void 0:v.is_anonymous,m);async function x(e){M.current&&M.current.contentWindow&&M.current.contentWindow.postMessage({action:"setLocalStorage",data:e},"*")}async function P(e){let t,n=e.data.payload,a=e.data.requestId;try{t={blob:await (0,o.mP)(n)}}catch(e){console.error(e),t={message:"Error fetching asset generation response"}}e.source.postMessage({action:"ephemeralImageGenerationResponse",content:t,requestId:a},e.origin)}function N(){if(!M.current||!M.current.contentWindow)return;let e={action:"update",content:n.content};M.current.contentWindow.postMessage(e,"*")}return(0,s.useImperativeHandle)(t,()=>M.current,[M]),(0,s.useEffect)(()=>{w&&(window.setIframeLocalStorage=x)},[w]),(0,s.useEffect)(()=>{let e="".concat("https://canvas.play.rosebud.ai","/canvas/").concat(g);"phaser"===g&&w&&(e+="_webkit"),T(e+=window.location.hash)},[g,w]),(0,s.useEffect)(()=>{async function e(e){let t;(0,i.mO)(m);let n=e.data.payload;n.project_id=m;let a=e.data.requestId;try{t=await (0,o.rJ)(n)}catch(n){var r,s;let e="Error fetching LLM response";(null==(r=n.response)?void 0:r.status)===403&&(null==(s=n.response.data)?void 0:s.detail)==="No more entitlements available"&&(w?I():"AUTHENTICATED"===b?H(!0):h({callbackIfSignedOut:()=>{}}),e=w||"AUTHENTICATED"===b?"Subscribe for unlimited messages":"Sign in to continue using AI Chat"),console.error(n),t={message:e}}e.source.postMessage({action:"llmResponse",content:t,requestId:a},e.origin)}async function t(e){let t=e.data.points;(0,i.YH)(t);let n=e.data.requestId,a=await L(t);e.source.postMessage({action:"ogpSubmitPoints",content:a,requestId:n},e.origin)}let a=async n=>{let{action:a}=n.data;"codeError"===a&&A&&A(n.data.content),"logProgress"===a&&(0,i.n1)(n.data.content.eventName,n.data.content.eventData),"scriptsLoaded"===a&&E&&E(n.data.content),"requestLLM"===a&&await e(n),"localStorageChanged"===a&&await _(n),"requestEphemeralImageGeneration"===a&&await P(n),"ogpSubmitPoints"===a&&await t(n)};if(n.content)return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}},[A,n.content,E,m,b,h,L,w,I,_]),(0,a.jsxs)("div",{className:(0,r.A)(f().Root,C&&f().FullScreen),children:[S&&(0,a.jsx)("button",{onClick:()=>{R(e=>!e)},className:f().FullScreenButton,children:C?(0,a.jsx)(l.A,{}):(0,a.jsx)(c.A,{})}),(0,a.jsx)("iframe",{ref:M,src:y,className:f().RenderDiv,sandbox:"allow-scripts allow-same-origin allow-pointer-lock allow-downloads allow-forms allow-popups",onLoad:()=>setTimeout(N,100),allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;","data-hj-allow-iframe":!0},"".concat(n.id,"-").concat(n.modified)),O&&(0,a.jsx)("div",{className:f().SubscribeBannerContainer,children:(0,a.jsx)(u.A,{message:"To continue enjoying the AI chat features in this project, please upgrade your plan."})})]})})},73914:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var a=n(95155),r=n(52596),s=n(12115),o=n(88248),i=n(99975),c=n(35758),l=n(27156),u=n(47745),d=n(89051),p=n(23172),m=n(29361),f=n(77268),g=n.n(f);let A=(0,s.forwardRef)(function(e,t){let{files:n,projectId:f,canvasType:A,onEvalError:E,onScriptsLoaded:S,showFullScreenButton:h=!0}=e,{requireSignIn:v,user:b}=(0,p.As)(),{authStatus:w}=(0,p.lB)(),[_,I]=(0,s.useState)(()=>"".concat("https://canvas.play.rosebud.ai","/canvas/").concat(A)),[y,T]=(0,s.useState)(!1),C=(0,s.useRef)(null),[R,M]=(0,s.useState)(!1),{submitPoints:O}=(0,m.O$)(null==b?void 0:b.id,null==b?void 0:b.is_anonymous,f),H=(0,s.useRef)(null),L=(0,s.useRef)(0),x=(0,s.useRef)(null),[P,N]=(0,s.useState)(!1);async function V(e){let t,n=e.data.payload,a=e.data.requestId;try{t={blob:await (0,o.mP)(n)}}catch(e){console.error(e),t={message:"Error fetching asset generation response"}}e.source.postMessage({action:"ephemeralImageGenerationResponse",content:t,requestId:a},e.origin)}if((0,s.useImperativeHandle)(t,()=>({iframe:C.current,takeScreenshot:()=>new Promise((e,t)=>{var n;if(!(null==(n=C.current)?void 0:n.contentWindow))return console.error("[MultiFile] Cannot request screenshot: iframe not ready."),e(null);if(H.current)return console.warn("[MultiFile] Screenshot request already in progress."),t(Error("Screenshot request already in progress."));H.current=e,C.current.contentWindow.postMessage({action:"requestScreenshot"},"*");let a=setTimeout(()=>{H.current&&(console.error("[MultiFile] Screenshot request timed out."),H.current(null),H.current=null)},5e3),r=H.current;H.current=e=>{clearTimeout(a),r&&r(e),H.current=null}})}),[]),(0,s.useEffect)(()=>{let e="".concat("https://canvas.play.rosebud.ai","/canvas/").concat(A);I(e+=window.location.hash)},[A]),(0,s.useEffect)(()=>{async function e(e){let t;(0,i.mO)(f);let n=e.data.payload;n.project_id=f;let a=e.data.requestId;try{t=await (0,o.rJ)(n)}catch(n){var r,s;let e="Error fetching LLM response";(null==(r=n.response)?void 0:r.status)===403&&(null==(s=n.response.data)?void 0:s.detail)==="No more entitlements available"&&("AUTHENTICATED"===w?M(!0):v({callbackIfSignedOut:()=>{}}),e="AUTHENTICATED"===w?"Subscribe for unlimited messages":"Sign in to continue using AI Chat"),console.error(n),t={message:e}}e.source.postMessage({action:"llmResponse",content:t,requestId:a},e.origin)}async function t(e){let t=e.data.points;(0,i.YH)(t);let n=e.data.requestId,a=await O(t);e.source.postMessage({action:"ogpSubmitPoints",content:a,requestId:n},e.origin)}let n=async n=>{let a=n.data.action;if("codeError"===a&&E&&(L.current++,x.current||(x.current=setTimeout(()=>{L.current>10&&N(!0),x.current=null,L.current=0},1e3)),E(n.data.content)),"logProgress"===a&&(0,i.n1)(n.data.content.eventName,n.data.content.eventData),"scriptsLoaded"===a&&S&&S(n.data.content),"requestLLM"===a&&await e(n),"requestEphemeralImageGeneration"===a&&await V(n),"ogpSubmitPoints"===a&&await t(n),"screenshotResponse"===a){let{content:e}=n.data;H.current&&H.current(e)}};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}},[E,S,f,w,v,O]),0===n.length)return(0,a.jsx)("div",{children:"No files"});if(n.some(e=>!e))return(0,a.jsx)("div",{children:"Some files are missing"});function j(){C.current&&C.current.contentWindow&&C.current.contentWindow.postMessage({type:"fileSystem",files:n},"*")}return(0,a.jsxs)("div",{className:(0,r.A)(g().Root,y&&g().FullScreen),children:[h&&(0,a.jsx)("button",{onClick:()=>{T(e=>!e)},className:g().FullScreenButton,children:y?(0,a.jsx)(l.A,{}):(0,a.jsx)(c.A,{})}),!P&&(0,a.jsx)("iframe",{ref:C,src:_,className:g().RenderDiv,sandbox:"allow-scripts allow-same-origin allow-pointer-lock allow-downloads allow-forms allow-popups",onLoad:()=>setTimeout(j,100),allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;","data-hj-allow-iframe":!0}),P&&(0,a.jsxs)("div",{className:g().InfiniteErrorContainer,children:[(0,a.jsx)(d.i,{}),(0,a.jsx)("span",{children:"Infinite error loop detected. Please check your code."})]}),R&&(0,a.jsx)("div",{className:g().SubscribeBannerContainer,children:(0,a.jsx)(u.A,{message:"To continue enjoying the AI chat features in this project, please upgrade your plan."})})]})})},77268:e=>{e.exports={RenderDiv:"GenericCanvasContainer_RenderDiv__xU0or",Root:"GenericCanvasContainer_Root__IxnDc",FullScreen:"GenericCanvasContainer_FullScreen__I0tZg",FullScreenButton:"GenericCanvasContainer_FullScreenButton__f3PIA",SubscribeBannerContainer:"GenericCanvasContainer_SubscribeBannerContainer__OWwYS",InfiniteErrorContainer:"GenericCanvasContainer_InfiniteErrorContainer___kPqL",fadeAndScaleIn:"GenericCanvasContainer_fadeAndScaleIn__dDSmk",fadeAndScaleOut:"GenericCanvasContainer_fadeAndScaleOut__L_fKF",scaleIn:"GenericCanvasContainer_scaleIn__VsahH",scaleOut:"GenericCanvasContainer_scaleOut__EVTG5"}},82104:e=>{e.exports={OGPAuthButton:"OgpSignInDialog_OGPAuthButton__xNQRo",fadeAndScaleIn:"OgpSignInDialog_fadeAndScaleIn__Q3PKl",fadeAndScaleOut:"OgpSignInDialog_fadeAndScaleOut__8qv2z",scaleIn:"OgpSignInDialog_scaleIn__T07uj",scaleOut:"OgpSignInDialog_scaleOut__JlzFJ"}},89051:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var a=n(95155),r=n(30546);let s=()=>(0,a.jsx)("svg",{width:r._,height:r._,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.8335 0.833008H9.16683V2.49967H7.50016V4.16634H5.8335V5.83301L4.16683 5.83301V7.49967H2.50016V9.16634H0.833496V10.833L2.50016 10.833V12.4997H4.16683V14.1663H5.8335V15.833H7.50016V17.4997H9.16683V19.1663H10.8335L10.8335 17.4997H12.5002V15.833H14.1668V14.1663H15.8335L15.8335 12.4997H17.5002V10.833L19.1668 10.833V9.16634H17.5002V7.49967H15.8335V5.83301L14.1668 5.83301V4.16634H12.5002V2.49967H10.8335V0.833008ZM10.8335 2.49967L10.8335 4.16634H12.5002V5.83301H14.1668V7.49967H15.8335L15.8335 9.16634H17.5002V10.833H15.8335V12.4997H14.1668V14.1663H12.5002V15.833L10.8335 15.833V17.4997H9.16683V15.833L7.50016 15.833V14.1663H5.8335V12.4997H4.16683V10.833H2.50016V9.16634H4.16683V7.49967H5.8335V5.83301H7.50016V4.16634H9.16683V2.49967H10.8335ZM10.8335 5.83301H9.16683V10.833H10.8335V5.83301ZM10.8335 12.4997H9.16683V14.1663H10.8335V12.4997Z",fill:"currentColor"})})},94784:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});let a={src:"/_next/static/media/rosie-starry-eyed-portrait-icon.7c031611.png",height:1080,width:1080,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAilBMVEW+PWtLHTS1WHn0zMGoLlulY3y9XoFrI1vM//+WIkz/u7v/1NuvOFuzWnS1RmPZQnPQNmluO1eeFU7dnqurQmy4MmPJfIOfNmyuUXODMGXbgphzGFySVn/lqqt9Fl6YPm7OaYylDUKFMU+JBDy9OGThcIzMO29tI0GqOGCiLGrdtKmxfID71smZJmUWntRlAAAAIXRSTlO5/fr+3HYglwL6DySzZav8/GP5PdbY/bisOv2HiPt8f/777doIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASklEQVR4nAXBBQKAIBAEwEVBxO6uAzv+/z1n4HphBOG48AMiIp4jNVmcKCPRnGrfqrUANHtudpSAtkbb0hzzt9hvd9VwJjkI2bc/qecFCqrQCfYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}}}]);